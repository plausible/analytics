!function(){async function t(t,{timeout:n,interval:o}){return e(t,n,o,1)}async function e(t,n,o,i){return new Promise(a=>{i*o>=n?a(t({timeout:!0})):"continue"!==t({timeout:!1})?a(t({timeout:!1})):setTimeout(()=>{a(e(t,n,o,i+1))},o)})}async function n(t){t("Starting snippet detection...");let e=await l();return e.all>0?(t(`Found snippets: head=${e.head}; body=${e.body}`),t("Waiting for additional snippets to appear..."),e=await u(),t(`Final snippet count: head=${e.head}, body=${e.body}`)):t("No snippets found after 5 seconds"),{nodes:[...o(),...i()],counts:e}}function o(){return document.querySelectorAll("head script[data-domain][src]")}function i(){return document.querySelectorAll("body script[data-domain][src]")}function a(){let t=o(),e=i();return{head:t.length,body:e.length,all:t.length+e.length}}async function l(){return await t(t=>{let e=a();return e.all>0||t.timeout?e:"continue"},{timeout:5e3,interval:100})}async function u(){return new Promise(t=>{setTimeout(()=>{t(a())},1e3)})}async function s(t){if(t("Checking for Plausible function..."),!await r())return t("Plausible function not found"),{plausibleInstalled:!1};{t("Plausible function found. Executing test event...");let e=await new Promise(e=>{let n=!1,o=setTimeout(()=>{n||(n=!0,t("Timeout waiting for Plausible function callback"),e({status:void 0}))},5e3);try{window.plausible("verification-agent-test",{callback:function(t){n||(n=!0,clearTimeout(o),e({status:t&&t.status?t.status:-1}))}})}catch(i){n||(n=!0,clearTimeout(o),t("Error calling plausible function:",i),e({status:-1}))}});return t(`Test event callback response: ${e.status}`),{plausibleInstalled:!0,callbackStatus:e.status}}}async function r(){return await t(t=>!!window.plausible||!t.timeout&&"continue",{timeout:5e3,interval:100})}let c=["wp-content","wp-includes","wp-json"],d=["googletagmanager.com/gtm.js"],m={cookiebot:["#CybotCookiebotDialogBodyButtonAccept","#CybotCookiebotDialogBody","#CybotCookiebotDialogBodyLevelButtonPreferences","#cb-cookieoverlay","#CybotCookiebotDialog","#cookiebanner"]},p=["data-domain","src","defer","data-api","data-exclude","data-include","data-cfasync"];window.verifyPlausibleInstallation=async function(t,e){var o,i,a,l;let u;function r(t){e&&console.log("[Plausible Verification]",t)}let[f,y]=await Promise.all([n(r),s(r)]),b=y.plausibleInstalled,g=y.callbackStatus||0,w=!!(o=f.nodes)&&0!==o.length&&o.some(e=>!e.getAttribute("data-domain").split(",").map(t=>t.trim()).some(e=>e.replace(/^www\./,"")===t));r(`dataDomainMismatch: ${w}`);let k=!!(i=f.nodes)&&0!==i.length&&i.some(t=>t.getAttribute("src").includes("manual."));r(`manualScriptExtension: ${k}`);let h=!!(a=f.nodes)&&0!==a.length&&a.some(t=>{let e=t.attributes;for(let t=0;t<e.length;t++){let n=e[t];if(("type"!==n.name||"text/javascript"!==n.value)&&!n.name.startsWith("event-")&&!p.includes(n.name))return!0}return!1});r(`unknownAttributes: ${h}`);let v=!!(l=f.nodes)&&0!==l.length&&l.some(t=>{let e=t.getAttribute("src");return e&&!/^https:\/\/plausible\.io\//.test(e)});r(`proxyLikely: ${v}`);let{wordpressPlugin:P,wordpressLikely:S}=function(t){if("object"==typeof t){var e;let n="function"==typeof t.querySelector&&null!==t.querySelector('meta[name="plausible-analytics-version"]'),o=n||"string"==typeof(e=t.documentElement?.outerHTML)&&c.some(t=>e.includes(t));return{wordpressPlugin:n,wordpressLikely:o}}return{wordpressPlugin:!1,wordpressLikely:!1}}(document);r(`wordpressPlugin: ${P}`),r(`wordpressLikely: ${S}`);let $=function(t){if("object"==typeof t){var e;return"string"==typeof(e=t.documentElement?.outerHTML)&&d.some(t=>e.includes(t))}return!1}(document);return r(`gtmLikely: ${$}`),u=!(b&&[200,202].includes(g))&&function(){for(let t of Object.keys(m))for(let e of m[t]){let t=document.querySelector(e);if(t&&function(t){let e=window.getComputedStyle(t);return"none"!==e.display&&"hidden"!==e.visibility&&null!==t.offsetParent}(t))return!0}return!1}(),r(`cookieBannerLikely: ${u}`),{data:{completed:!0,plausibleInstalled:y.plausibleInstalled,callbackStatus:y.callbackStatus||0,snippetsFoundInHead:f.counts.head,snippetsFoundInBody:f.counts.body,dataDomainMismatch:w,proxyLikely:v,wordpressPlugin:P,wordpressLikely:S,gtmLikely:$,cookieBannerLikely:u,manualScriptExtension:k,unknownAttributes:h}}}}();